(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),r=n(7),i=n.n(r),c=(n(13),n(5)),o=n(1),u=n(2),s=n(3),h=n(4),m=(n(14),n(15));function f(){var e=window.location,t=e.origin+e.pathname;return m("html"===t.slice(-4)),t.slice(0,-4)+"json"+e.search}function d(e,t){var n=e.fields.map((function(e){return{asc:"+",dsc:"-",null:""}[e.sort]+e.name})).join(","),a=e.filters.map((function(e){return"".concat(e.name,"__").concat(e.lookup,"=").concat(e.value)})).join("&");return"".concat(function(){var e=window.location,t=e.pathname.split("/");return e.origin+t.slice(0,-1).join("/")}(),"/").concat(n,".").concat(t,"?").concat(a)}function p(e){return l.a.createElement("button",{type:"button",className:"link "+(e.className||""),onClick:e.onClick},e.children)}var y=function(e){Object(h.a)(n,e);var t=Object(s.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"handleLookupChange",value:function(e){this.props.lookups.forEach((function(t){t.name===e.target.value&&(document.location.href=t.link)}))}},{key:"render",value:function(){return l.a.createElement("p",{className:this.props.filter.err_message?"error":void 0},l.a.createElement(p,{onClick:this.props.handleRemove},"\u2718")," ",this.props.filter.name," ",l.a.createElement("select",{value:this.props.filter.lookup,onChange:this.handleLookupChange.bind(this)},this.props.lookups.map((function(e){return l.a.createElement("option",{key:e.name,value:e.name},e.name)})))," ","="," ",l.a.createElement("input",{type:"text",name:"".concat(this.props.filter.name,"__").concat(this.props.filter.lookup),value:this.props.filter.value}),this.props.filter.err_message)}}]),n}(l.a.Component);function g(e){return l.a.createElement("form",{className:"filters",method:"get"},e.lightQuery.filters.map((function(t,n){return l.a.createElement(y,{filter:t,lookups:e.query.filters[n]?e.query.filters[n].lookups:[],key:n,handleRemove:function(){var t=e.lightQuery.filters.slice();t.splice(n,1),e.handleQueryChange({filters:t})}})})),l.a.createElement("p",null,l.a.createElement("input",{type:"submit"})))}var E=function(e){Object(h.a)(n,e);var t=Object(s.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={isToggleOn:!1},a}return Object(u.a)(n,[{key:"handleClick",value:function(){this.setState((function(e){return{isToggleOn:!e.isToggleOn}}))}},{key:"render",value:function(){return this.state.isToggleOn?l.a.createElement(l.a.Fragment,null,l.a.createElement(p,{className:"toggle_link",onClick:this.handleClick.bind(this)},"> ",this.props.title),l.a.createElement("div",{className:"toggle_div"},this.props.children)):l.a.createElement(p,{className:"toggle_link",onClick:this.handleClick.bind(this)},"+ ",this.props.title)}}]),n}(l.a.Component);function v(e){return l.a.createElement("ul",{className:"fields_list"},e.fields.map((function(t){return l.a.createElement("li",{key:t.name},t.concrete?l.a.createElement(p,{onClick:function(){var n=e.query.filters.slice();n.push({err_message:null,name:t.name,lookup:"",value:""}),e.handleQueryChange({filters:n})}},"Y"):l.a.createElement(l.a.Fragment,null,"\xa0\xa0")," ",l.a.createElement(p,{onClick:function(){var n=e.query.fields.slice();n.push({name:t.name,sort:null,concrete:!1}),e.handleQueryChange({fields:n})}},t.name))})),e.fks.map((function(e){return l.a.createElement("li",{key:e.name},l.a.createElement(E,{title:e.name},l.a.createElement(v,e)))})))}function k(e){return l.a.createElement("thead",null,l.a.createElement("tr",null,e.query.fields.map((function(t,n){return l.a.createElement("th",{key:t.name},l.a.createElement(p,{onClick:function(){var t=e.query.fields.slice();t.splice(n,1),e.handleQueryChange({fields:t})}},"\u2718")," ",t.concrete?l.a.createElement(l.a.Fragment,null,l.a.createElement(p,{onClick:function(){var n=e.query.filters.slice();n.push({err_message:null,name:t.name,lookup:"",value:""}),e.handleQueryChange({filters:n})}},"Y")," ",l.a.createElement(p,{onClick:function(){var a=e.query.fields.slice();a[n]=Object(c.a)({},t,{sort:{asc:"dsc",dsc:null,null:"asc"}[t.sort]}),e.handleQueryChange({fields:a})}},t.name)," ",{dsc:"\u2191",asc:"\u2193",null:""}[t.sort]):t.name)})),!e.query.fields.length&&l.a.createElement("th",null,"No fields selected")))}function C(e){return l.a.createElement("tbody",null,e.data.map((function(e,t){return l.a.createElement("tr",{key:t},e.map((function(e,t){return l.a.createElement("td",{key:t},e)})))})))}function Q(e){return l.a.createElement("table",null,l.a.createElement(k,{query:e.query,handleQueryChange:e.handleQueryChange}),l.a.createElement(C,{data:e.data}))}function b(e){return l.a.createElement("div",{id:"body"},l.a.createElement("h1",null,e.query.model),l.a.createElement("p",null,l.a.createElement("a",{href:d(e.lightQuery,"csv")},"Download as CSV")),l.a.createElement("p",null,l.a.createElement("a",{href:e.query.save_link},"Save View")),l.a.createElement(g,{query:e.query,lightQuery:e.lightQuery,handleQueryChange:e.handleQueryChange}),l.a.createElement("p",null,"Showing ",e.data.length," results"),l.a.createElement("div",{className:"main_space"},l.a.createElement("div",null,l.a.createElement(v,Object.assign({query:e.lightQuery,handleQueryChange:e.handleQueryChange},e.all_fields))),l.a.createElement(Q,{query:e.lightQuery,handleQueryChange:e.handleQueryChange,data:e.data})))}var j=function(e){Object(h.a)(n,e);var t=Object(s.a)(n);function n(e){var a;Object(o.a)(this,n),a=t.call(this,e);var l=JSON.parse(document.getElementById("django-data").textContent);return a.state={data:[],lightQuery:{filters:[],fields:[]},query:l.query,all_fields:l.all_fields},a}return Object(u.a)(n,[{key:"fetchData",value:function(e){var t=this;fetch(e).then((function(e){return e.json()})).then((function(e){t.setState({data:e.data,lightQuery:{fields:e.fields,filters:e.filters}})}),(function(e){t.setState({error:e})}))}},{key:"componentDidMount",value:function(){var e=this;this.fetchData(f()),window.onpopstate=function(t){e.fetchData(f())}}},{key:"handleQueryChange",value:function(e){var t=Object(c.a)({},this.state.lightQuery,{},e);window.history.pushState(null,null,d(t,"html")),this.fetchData(d(t,"json"))}},{key:"render",value:function(){return l.a.createElement(b,{data:this.state.data,lightQuery:this.state.lightQuery,query:this.state.query,all_fields:this.state.all_fields,handleQueryChange:this.handleQueryChange.bind(this)})}}]),n}(l.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,n){e.exports=n(21)}},[[8,1,2]]]);
//# sourceMappingURL=main.cec91c65.chunk.js.map