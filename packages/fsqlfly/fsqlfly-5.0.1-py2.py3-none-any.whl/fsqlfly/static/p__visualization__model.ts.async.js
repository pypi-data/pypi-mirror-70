(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"Dz5+":function(e,t,a){"use strict";a.r(t);var r=a("gWZ8"),n=a.n(r),s=a("p0pE"),c=a.n(s),i=(a("miYZ"),a("tsqr")),l=a("d6i3"),u=a.n(l),o=a("1l/V"),p=a.n(o),f=a("sy1d");function d(){return b.apply(this,arguments)}function b(){return(b=p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(f.a)(" /api/tables",{params:{_time:(new Date).getTime()}}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function m(){return y.apply(this,arguments)}function y(){return(y=p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(f.a)(" /api/table_names",{params:{_time:(new Date).getTime()}}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h(e){return v.apply(this,arguments)}function v(){return(v=p()(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=3===t.length?t[1]+"."+t[2]:"",e.abrupt("return",Object(f.a)("/api/table/".concat(a),{params:{_time:(new Date).getTime()}}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function x(e,t){return w.apply(this,arguments)}function w(){return(w=p()(u.a.mark(function e(t,a){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(f.a)("/api/search/".concat(t),{params:c()({_time:(new Date).getTime()},a),data:a,method:"POST"}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function T(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return g(e,t)}(e))){var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,n,s=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,n=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw n}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var k={namespace:"visualization",state:{tables:[],relatedTables:[],details:[],search:"",selectTable:[],limit:500,currentDisplayTables:[],selectRelatedTableKeys:[],errorDisplay:!1,errorCode:0,errorMsg:"",tableNames:[]},effects:{fetchTables:u.a.mark(function e(t,a){var r,n,s,c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.payload,r=a.call,n=a.put,e.next=4,r(d);case 4:return s=e.sent,e.next=7,n({type:"save",payload:{tables:s.data.data}});case 7:return e.next=9,r(m);case 9:return c=e.sent,e.next=12,n({type:"save",payload:{tableNames:c.data}});case 12:case"end":return e.stop()}},e)}),doRefresh:u.a.mark(function e(t,a){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.call,r=a.put,e.next=3,r({type:"save",payload:{tables:[],relatedTables:[],details:[],selectTable:"",limit:-1,currentDisplayTables:[],selectRelatedTableKeys:[],errorDisplay:!1,errorCode:0,errorMsg:""}});case 3:return e.next=5,r({type:"fetchTables"});case 5:case"end":return e.stop()}},e)}),submitSearch:u.a.mark(function e(t,a){var r,n,s,c,l,o,p,f,d;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.payload,r=a.call,n=a.put,s=a.select,e.next=4,s(function(e){return e.visualization});case 4:return c=e.sent,l=c.limit,o=c.search,p=c.selectTable,f=3===p.length?p.slice(1,3).join("."):"",e.next=11,r(x,f,{limit:l,search:o});case 11:if(void 0!==(d=e.sent).code&&0===d.code){e.next=16;break}return e.next=15,n({type:"save",payload:{errorDisplay:!0,errorCode:d.code,errorMsg:d.msg}});case 15:return e.abrupt("return");case 16:return e.next=18,n({type:"saveTableSearch",payload:d.data});case 18:i.a.destroy();case 22:case"end":return e.stop()}},e)}),hiddenTableDetail:u.a.mark(function e(t,a){var r,n,s,i,l,o,p,f;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,a.call,n=a.put,s=a.select,i=r.tableName,e.next=5,s(function(e){return e.visualization.details.filter(function(e){return e.tableName==i})});case 5:l=e.sent,o=0;case 7:if(!(o<l.length)){e.next=15;break}return p=l[o],f=c()({},p,{show:r.check}),e.next=12,n({type:"saveTableSearch",payload:f});case 12:o++,e.next=7;break;case 15:case"end":return e.stop()}},e)}),submitSelectTable:u.a.mark(function e(t,a){var r,n,s,c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,n=a.call,s=a.put,e.next=4,s({type:"save",payload:{selectTable:r,selectRelatedTableKeys:[]}});case 4:return e.next=6,n(h,r);case 6:return c=e.sent,e.next=9,s({type:"save",payload:{relatedTables:Array.isArray(c.data.data)?c.data.data:[]}});case 9:case 12:case"end":return e.stop()}},e)}),submitSearchAll:u.a.mark(function e(t,a){var r,n,s,c,i,l,o,p,f,d,b,m;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,a.call,n=a.put,s=a.select,e.next=5,s(function(e){return e.visualization});case 5:return c=e.sent,i=c.selectTable,l=c.search,o=c.limit,e.next=11,s(function(e){return e.visualization});case 11:if(p=e.sent,void 0!==p.current){e.next=16;break}return e.next=16,n({type:"submitSearchOne",payload:{params:{selectTable:i,search:l,limit:o,table:i}}});case 16:f=T(r),e.prev=17,f.s();case 19:if((d=f.n()).done){e.next=29;break}return b=d.value,e.next=24,n({type:"saveTableSearch",payload:{tableName:b,loading:!0,show:!0}});case 24:return m=3===i.length?i.slice(1,3).join("."):"",e.next=27,n({type:"submitSearchOne",payload:{params:{selectTable:m,search:l,limit:o,table:b}}});case 27:e.next=19;break;case 29:e.next=34;break;case 31:e.prev=31,e.t0=e.catch(17),f.e(e.t0);case 34:return e.prev=34,f.f(),e.finish(34);case 37:case"end":return e.stop()}},e,null,[[17,31,34,37]])}),submitSearchOne:u.a.mark(function e(t,a){var r,n,s,i;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,n=a.call,s=a.put,e.next=4,n(x,r.params.table,r.params);case 4:if(void 0!==(i=e.sent).code&&0===i.code){e.next=9;break}return e.next=8,s({type:"save",payload:{errorDisplay:!0,errorCode:i.code,errorMsg:i.msg}});case 8:return e.abrupt("return");case 9:return e.next=11,s({type:"saveTableSearch",payload:c()({},i.data,{loading:!1})});case 11:case"end":return e.stop()}},e)}),startChangeCurrentTable:u.a.mark(function e(t,a){var r,n,s,c,i;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.tableNames,a.call,n=a.put,s=a.select,e.next=4,s(function(e){return e.visualization});case 4:if(c=e.sent,c.selectTable.join(".")===r.join(".")){e.next=9;break}return e.next=9,n({type:"submitSelectTable",payload:r});case 9:return i=3===r.length?r.slice(1,3).join("."):"",e.next=12,n({type:"changeCurrentTable",tableName:i});case 12:case"end":return e.stop()}},e)})},reducers:{save:function(e,t){var a=t.payload;return c()({},e,a)},saveTableSearch:function(e,t){var a,r=t.payload;if(void 0!==(a=void 0!==e&&3===e.selectTable.length&&r.tableName===e.selectTable.slice(1,3).join(".")?c()({},e,{current:r}):e)&&0===a.details.filter(function(e){return e.tableName===r.tableName}).length){var s=[].concat(n()(a.details),[r]);return c()({},a,{details:s})}if(void 0!==a){var i=a.details.map(function(e){return e.tableName===r.tableName?r:e});return c()({},a,{details:i})}},changeCurrentTable:function(e,t){var a=t.tableName;if(void 0!==e){var r=e.details.filter(function(e){return e.tableName===a});if(r.length>0){var n=r[0];return c()({},e,{current:n,selectTable:n.tableName,search:n.search,limit:n.limit})}}return e},deleteTable:function(e,t){var a=t.tableName;return c()({},e,{details:e.details.filter(function(e){return e.tableName!==a})})}}};t.default=k}}]);