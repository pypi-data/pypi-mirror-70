(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{SiJX:function(e,t,a){"use strict";a.r(t);a("Mwp2");var n=a("VXEj"),l=(a("IzEo"),a("bx4M")),r=(a("MXD1"),a("CFYs")),c=(a("lUTK"),a("BvKs")),s=(a("qVdP"),a("jsC+")),i=(a("+L6B"),a("2/Rp")),m=(a("5NDa"),a("5rEg")),o=(a("7Kak"),a("9yH6")),u=(a("2qtc"),a("kLXV")),p=(a("5Dmo"),a("3S7+")),d=(a("+BJd"),a("mr32")),f=(a("Telt"),a("Tckk")),E=(a("miYZ"),a("tsqr")),N=a("p0pE"),h=a.n(N),v=a("2Taf"),g=a.n(v),y=a("vZ4D"),k=a.n(y),I=a("MhPg"),C=a.n(I),b=a("l4Ni"),R=a.n(b),L=a("ujKo"),S=a.n(L),D=a("q1tI"),x=a.n(D),T=a("MuoO"),j=a("8Skl"),w=a("WsrF"),O=(a("XlDN"),a("rLCj")),B=a("4NGg"),F=a.n(B),U=a("c+yx");function G(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=S()(e);if(t){var l=S()(this).constructor;a=Reflect.construct(n,arguments,l)}else a=n.apply(this,arguments);return R()(this,a)}}var A="job",M=function(e){C()(a,e);var t=G(a);function a(){var e;return g()(this,a),(e=t.apply(this,arguments)).state={search:"",tag:0,status:"RUNNING"},e.doRefresh=function(){(0,e.props.dispatch)({type:"".concat(A,"/fetch")})},e.stopRunTerminal=function(t){var a=e.props.dispatch;a({type:"".concat(A,"/run"),payload:h()({},t,{method:"cancel",model:A}),callback:function(e){e.success?(E.a.success("删除成功！"),a({type:"".concat(A,"/deleteOne"),payload:{id:t.id}})):E.a.error(e.msg)}})},e.getListContent=function(){var t=e.state,a=t.tag,n=t.search,l=t.status;return e.props.listBasicList.filter(function(e){var t=e.name.indexOf(n)>=0&&(0===a||e.namespaceId===a);return"ALL"===l?t:e.status===l&&t})},e.getNamespace=function(t){if(void 0===t)return null;var a=e.props.namespaces.filter(function(e){return e.id===t});return 0===a.length?null:a[0]},e.getNamespaceAvatar=function(t){var a=e.getNamespace(t.namespaceId);return null===a?x.a.createElement(f.a,{alt:t.info,shape:"circle",size:"large"},t.name.substr(0,2)):x.a.createElement(f.a,{src:null===a?"":a.avatar,alt:t.info,shape:"circle",size:"large"})},e.getNamespaceTitle=function(t){var a=e.getNamespace(t);return null===a?x.a.createElement(d.a,null,"-"):x.a.createElement(p.a,{title:a.name,placement:"top"},x.a.createElement(d.a,null,Object(U.c)(a.name)))},e}return k()(a,[{key:"componentDidMount",value:function(){this.doRefresh()}},{key:"render",value:function(){var e=this,t=this.props,a=t.namespaces,f=t.loading,E=o.a.Group,N=o.a.Button,h=m.a.Search,v=this.state.search,g=x.a.createElement("div",{className:F.a.extraContent},x.a.createElement(i.a,{onClick:this.doRefresh,style:{marginRight:20}},x.a.createElement(O.a,null)),x.a.createElement(E,{defaultValue:null,onChange:function(t){return e.setState({tag:t.target.value})}},x.a.createElement(N,{className:F.a.namespaceButton,value:0},"全部"),a.length>0&&a.slice(0,6).map(function(e){return x.a.createElement(p.a,{title:e.name,placement:"left"},x.a.createElement(N,{className:F.a.namespaceButton,key:e.id,value:e.id},Object(U.c)(e.name)))}),a.length>6&&x.a.createElement(s.a,{className:F.a.namespaceButton,overlay:x.a.createElement(c.a,{onClick:function(t){var a=t.key;return e.setState({tag:parseInt(a)})}},a.slice(6,a.length+1).map(function(e){return x.a.createElement(c.a.Item,{key:e.id},x.a.createElement(p.a,{title:e.name,placement:"left"},x.a.createElement("span",null,Object(U.c)(e.name))))}))},x.a.createElement(i.a,null,"更多",x.a.createElement(j.a,null))),x.a.createElement(s.a,{className:F.a.namespaceButton,overlay:x.a.createElement(c.a,{onClick:function(t){var a=t.key;return e.setState({status:a})}},["ALL","RUNNING","CANCELED","FAILED","FINISHED","SUSPENDED","RECONCILING"].map(function(e){return x.a.createElement(c.a.Item,{key:e},x.a.createElement("span",null,e))}))},x.a.createElement(i.a,null,"状态",x.a.createElement(j.a,null)))),x.a.createElement(h,{defaultValue:v,className:F.a.extraContentSearch,placeholder:"请输入名或者命名空间搜索",onSearch:function(t){return e.setState({search:t})}})),y=function(t){var a=t.data,n=(a.name,a.startTime),l=a.endTime,c=a.status,s=a.namespaceId,i=a.duration;return x.a.createElement("div",{className:F.a.listContent},x.a.createElement("div",{className:F.a.listContentItem},e.getNamespaceTitle(s)),x.a.createElement("div",{className:F.a.listContentItem},x.a.createElement("span",null,"开始时间"),x.a.createElement(p.a,{placement:"top",title:i},x.a.createElement("p",null,n))),x.a.createElement("div",{className:F.a.listContentItem},x.a.createElement("span",null,"结束时间"),x.a.createElement("p",null,"-"===l?"0000-00-00 00:00:00":l)),x.a.createElement("div",{className:F.a.listContentItem},x.a.createElement(r.a,{type:"circle",percent:100,status:"RUNNING"===c?"success":"FAILED"===c?"exception":"normal",strokeWidth:1,width:50,style:{width:180},format:function(){return c}})))},k=function(t){var a=t.item;return x.a.createElement(s.a,{overlay:"RUNNING"===a.status||void 0!==a.url?x.a.createElement(c.a,{onClick:function(t){return function(t,a){"stop"==t?u.a.confirm({title:"停止Flink任务",content:"确定停止Flink任务吗？",okText:"确认",cancelText:"取消",onOk:function(){return e.stopRunTerminal(a)}}):window.location.href=t}(t.key,a)}},"RUNNING"===a.status&&x.a.createElement(c.a.Item,{key:"stop"},"停止"),void 0!==a.url&&x.a.createElement(c.a.Item,{key:a.url},"连接")):x.a.createElement("span",null)},x.a.createElement("a",null,"更多 ",x.a.createElement(j.a,null)))};return x.a.createElement(x.a.Fragment,null,x.a.createElement("div",{className:F.a.standardList},x.a.createElement(l.a,{className:F.a.listCard,bordered:!1,title:"Flink Job",style:{marginTop:24},bodyStyle:{padding:"0 32px 40px 32px"},extra:g},x.a.createElement(n.b,{size:"large",rowKey:"id",loading:f,dataSource:this.getListContent(),renderItem:function(t){return x.a.createElement(n.b.Item,{key:t.id,actions:[x.a.createElement(p.a,{title:t.fullName,placement:"left"},x.a.createElement("a",{href:t.detailUrl,target:"_blank"},"详情")),x.a.createElement(k,{key:"more",item:t})]},x.a.createElement(n.b.Item.Meta,{title:x.a.createElement(p.a,{title:t.name,placement:"left"},x.a.createElement("a",{href:t.detailUrl,target:"_blank"},Object(U.c)(t.name),null===t.pt?"":x.a.createElement(d.a,null,t.pt))),avatar:e.getNamespaceAvatar(t),description:x.a.createElement(p.a,{title:void 0!==t.info?t.info:""},x.a.createElement("span",null,Object(U.c)(t.info)))}),x.a.createElement(y,{data:t}))}}))))}}]),a}(D.Component),J=w.a.create()(M);t.default=Object(T.connect)(function(e){var t=e.job,a=e.loading;return{listBasicList:t.list,namespaces:t.dependence,loading:a.models.namespace}})(J)}}]);